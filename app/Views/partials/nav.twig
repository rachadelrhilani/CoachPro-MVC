<nav class="sticky top-4 z-50 mx-auto max-w-7xl px-4 sm:px-6">
    <div class="backdrop-blur-md bg-white/80 border border-white/20 shadow-[0_8px_32px_0_rgba(31,38,135,0.07)] rounded-[2rem] px-6">
        <div class="flex h-16 items-center justify-between">

            <a href="{{ base_url }}/" class="flex items-center gap-3 group shrink-0">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-tr from-indigo-600 via-indigo-500 to-purple-500 flex items-center justify-center shadow-indigo-200 shadow-lg group-hover:rotate-6 transition-transform duration-300">
                    <span class="text-white font-black text-xl italic">C</span>
                </div>
                <span class="text-xl font-black tracking-tight text-slate-800">
                    Coach<span class="text-indigo-600">Pro</span>
                </span>
            </a>

            {% if session.user is defined %}
            <div class="hidden md:flex items-center bg-slate-100/50 p-1 rounded-2xl border border-slate-200/50">
                
                {% macro link(url, label, active) %}
                    <a href="{{ url }}"
                       class="px-4 py-2 rounded-xl text-sm font-bold transition-all duration-300 
                       {{ active ? 'bg-white text-indigo-600 shadow-sm' : 'text-slate-500 hover:text-indigo-600' }}">
                        {{ label }}
                    </a>
                {% endmacro %}

                {% if session.user.role == 'sportif' %}
                    {{ _self.link(base_url ~ '/sportif/coaches', 'Coachs', active == 'sportif.coaches') }}
                    {{ _self.link(base_url ~ '/sportif/seances', 'Séances', active == 'sportif.seances') }}
                    {{ _self.link(base_url ~ '/sportif/history', 'Réservations', active == 'sportif.history') }}
                {% endif %}

                {% if session.user.role == 'coach' %}
                    {{ _self.link(base_url ~ '/coach/seances', 'Mes Séances', active == 'coach.seances') }}
                    {{ _self.link(base_url ~ '/coach/reservations', 'Reservations', active == 'coach.reservations') }}
                {% endif %}
            </div>

            <div class="hidden md:flex items-center gap-4">
               <p class="text-sm font-bold text-slate-700">
    {{ session.user.prenom }} {{ session.user.nom }}
</p>

                <a href="{{ base_url }}/{{ session.user.role }}/profile" class="flex items-center gap-2 group">
                    <div class="w-8 h-8 rounded-full bg-indigo-50 flex items-center justify-center border border-indigo-100 group-hover:bg-indigo-600 transition-colors">
                        <svg class="w-4 h-4 text-indigo-600 group-hover:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" stroke-width="2"/></svg>
                    </div>
                </a>
                <div class="h-4 w-px bg-slate-200"></div>
                <a href="{{ base_url }}/logout" class="text-sm font-bold text-slate-400 hover:text-red-500 transition-colors">
                    Quitter
                </a>
            </div>

            {% else %}
            <div class="hidden md:flex items-center gap-6">
                <a href="{{ base_url }}/login" class="text-sm font-bold text-slate-600 hover:text-indigo-600 transition-colors">Connexion</a>
                <a href="{{ base_url }}/register" class="px-6 py-2.5 rounded-full bg-slate-900 text-white text-sm font-bold hover:bg-indigo-600 hover:shadow-lg hover:shadow-indigo-200 transition-all duration-300">
                    Rejoindre
                </a>
            </div>
            {% endif %}

            <button id="menuBtn" class="md:hidden p-2 rounded-xl bg-slate-50 text-slate-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"/></svg>
            </button>
        </div>
    </div>

    <div id="mobileMenu" class="hidden absolute top-20 left-4 right-4 bg-white rounded-[2rem] border border-slate-100 shadow-2xl p-6 flex-col gap-4 animate-in fade-in slide-in-from-top-4 duration-300">
        {% if session.user %}
            <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">Menu Principal</span>
            <a href="{{ base_url }}/logout" class="mt-4 p-4 rounded-2xl bg-red-50 text-red-600 text-center font-bold">Déconnexion</a>
        {% else %}
            <a href="{{ base_url }}/login" class="p-4 rounded-2xl bg-slate-50 text-center font-bold">Connexion</a>
            <a href="{{ base_url }}/register" class="p-4 rounded-2xl bg-indigo-600 text-white text-center font-bold">Inscription</a>
        {% endif %}
    </div>
</nav>