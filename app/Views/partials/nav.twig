<nav class="sticky top-0 z-50 backdrop-blur-xl bg-white/70 border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-6">
        <div class="flex h-20 items-center justify-between">

            <!-- Logo -->
            <a href="{{ base_url }}/" class="flex items-center gap-3 group">
                <div class="w-11 h-11 rounded-2xl bg-gradient-to-br from-indigo-600 to-purple-600 flex items-center justify-center shadow-lg group-hover:scale-110 transition">
                    <span class="text-white font-bold text-xl">C</span>
                </div>
                <span class="text-2xl font-extrabold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
                    CoachPro
                </span>
            </a>

            <!-- Desktop menu -->
            {% if session.user is defined %}
            <div class="hidden md:flex items-center gap-2 bg-white/80 rounded-2xl px-3 py-2 shadow-inner">

                {% macro link(url, label, icon, active) %}
                    <a href="{{ url }}"
                       class="flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition
                       {{ active ? 'bg-indigo-600 text-white shadow-md' : 'text-gray-700 hover:bg-indigo-50 hover:text-indigo-600' }}">
                        {{ icon|raw }}
                        {{ label }}
                    </a>
                {% endmacro %}

                {% if session.user.role == 'sportif' %}
                    {{ _self.link(base_url ~ '/sportif/coaches', 'Coachs', '', active == 'sportif.coaches') }}
                    {{ _self.link(base_url ~ '/sportif/seances', 'Séances', '', active == 'sportif.seances') }}
                    {{ _self.link(base_url ~ '/sportif/history', 'Réservations', '', active == 'sportif.history') }}
                {% endif %}

                {% if session.user.role == 'coach' %}
                    {{ _self.link(base_url ~ '/coach/seances', 'Séances', '', active == 'coach.seances') }}
                    {{ _self.link(base_url ~ '/coach/profile', 'Profil', '', active == 'coach.profile') }}
                    {{ _self.link(base_url ~ '/coach/reservations', 'Réservations', '', active == 'coach.reservations') }}
                {% endif %}

                <!-- Divider -->
                <div class="w-px h-6 bg-gray-300 mx-2"></div>

                <!-- Logout -->
                <a href="{{ base_url }}/logout"
                   class="px-4 py-2 rounded-xl text-sm font-semibold text-red-600 hover:bg-red-600 hover:text-white transition shadow-sm">
                    Déconnexion
                </a>
            </div>

            {% else %}
            <!-- Auth buttons -->
            <div class="hidden md:flex gap-3">
                <a href="{{ base_url }}/login"
                   class="px-5 py-2.5 rounded-xl border border-indigo-300 text-indigo-600 hover:bg-indigo-50 transition">
                    Connexion
                </a>
                <a href="{{ base_url }}/register"
                   class="px-5 py-2.5 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold hover:scale-105 transition shadow-lg">
                    Inscription
                </a>
            </div>
            {% endif %}

            <!-- Mobile button -->
            <button id="menuBtn" class="md:hidden w-10 h-10 flex items-center justify-center rounded-xl hover:bg-gray-100">
                ☰
            </button>
        </div>
    </div>

    <!-- Mobile menu -->
    <div id="mobileMenu" class="hidden md:hidden bg-white border-t px-6 py-4 space-y-2">
        {% if session.user %}
            <a href="{{ base_url }}/logout" class="block text-red-600 font-semibold">Déconnexion</a>
        {% else %}
            <a href="{{ base_url }}/login">Connexion</a>
            <a href="{{ base_url }}/register">Inscription</a>
        {% endif %}
    </div>
</nav>

<script>
document.getElementById('menuBtn')?.addEventListener('click', () => {
    document.getElementById('mobileMenu').classList.toggle('hidden');
});
</script>
